\section{Experimental Results}  \label{sec:exp}

\subsection{Experimental Setup}

\subsubsection{Datasets}

\paragraph*{Berkeley Dataset}

The Intel Berkeley Research lab dataset~\cite{berkeley2004lab} records temperature, humidity, light, and voltage for 54 sensors (with 1 missing completely missing) for which locations are given (see Figure \ref{berkeley_lab}).
The dataset includes 2.3M sensor observations, over 210K timesteps, and was recorded between February 28th and April 5th, 2004 in an indoor lab environment.

\begin{figure}[H]
\centering
\includegraphics[scale=0.25]{berkeley_lab.png}
\caption{Intel Berkeley Research Lab Floorplan} \label{berkeley_lab}
\end{figure}

\paragraph*{Traffic Dataset}

The Traffic Dataset records the temperature, humidity, and voltage conditions of 20 sensor nodes and one gateway node.
This dataset, collected by the Bio-industrial Department at National Taiwan University, was recorded over a 2.5 year time period ending in 2011 in an outdoor location high traffic area in Taipei, Taiwan. \redtext{Include citation for Traffic Dataset! (Chun contacting authors)}

\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{traffic_wsn.png}
\caption{Traffic Sensor Deployment Configuration (7 sensors of 20 shown)}
\end{figure}

\subsubsection{Dataset Preparation}

\paragraph*{Berkeley Dataset Outlier Removal and Gridding}

Outlier Filtering : Observation removed if temperature $> 100\degc$, temperature $< 5\degc$, or humidity $< 16\%$.

Gridding : Dataset falls on even 30s intervals for the first 5000 time steps (which is all we consider), so no additional gridding need be performed.

\paragraph*{Traffic Dataset Outlier Removal and Gridding}

Outlier Filtering : \redtext{this was done by chung-yi.. please fill this in!}

Gridding : The original dataset recorded most readings at around the $xx:03$ and $xx:33$ minute marks, so a $6$ min window centered at
these points captured the data for $30$ minute internal readings.
Where more than one reading was recorded for a given node within a given window, the closest to the $3$ or $33$ minute mark was chosen.
The full length of the dataset was used, which consists of $~43$K time-steps.

\paragraph*{Common Methodology}

%Datasets of various lengths are produced from the single input dataset for our experiments, namely 2500, 5000, and 10000.
There is an initially missing portion of the observations which can be considered Missing At Random (MAR).
To this, we impose two different types of Missing Completely At Random (MCAR) sampling techniques to build validation and testing datasets.

\paragraph*{Random Missing Pattern}

This pattern reflects choosing a random time and random sensor to be missing and hence removed from the training set.
We define two values $x$ and $y$ as follows.

\begin{itemize}
\item $10\%$ of the non-missing data is randomly selected (without replacement) to be the validation set
\item $y\%$ of the non-missing data is randomly selected (without replacement) to be the testing set
\item The remaining data is part of the training set (this would be $x\%$ of the total data given no missing; assuming missing rate of $m\%$, the actual data in training set is $90\%-x\%-m\%$
\end{itemize}

\paragraph*{Temporal Missing Pattern}

This pattern reflects testing the effect of all data missing after a certain point in time.
We define two values $x$ and $y$ as follows.

\begin{itemize}
\item Here, we have the last $y\%$ of time is in test and the prior $10\%$ to test is the validation.
\item The sensor node numbers ``covered up'' in the validation and testing for the Berkeley and Traffic datasets are ${4,21,45}$ and ${2,4,6,8,10,14,17,19,20,21}$, respectively.
Note that node $21$ of the Traffic dataset is the gateway node.
\end{itemize}

\subsection{Basic Experimental Results} %from Chung-Yi
We compare linear interpolation~(LI), TRMF, AKE, DESM and STI on the two data sets. Note that the sensor location information is not available in traffic data set, so we assume the distance between all sensor node pairs are equal for DESM and STI.

%validation setting
\subsubsection{Random Split}
Table \ref{table:berkeley_random_hum}, \ref{table:berkeley_random_light} and \ref{table:berkeley_random_tem} show the result of random split on Berkeley data set. TRMF outperforms others greatly in all cases. On the other hand, linear interpolation is quite competitive, especially when the size of training set is large. This is because the sampling rate of Berkeley data set is fairly high and the temporal correlation is prominent. 

\begin{table}[htbp]
\centering
\caption{RMSE of (Berkeley, random, humidity)}
\label{table:berkeley_random_hum}
\begin{tabular}{ r | r r r r r}
	train	&LI	&TRMF	&AKE	&DESM	&STI\\ \hline
%	5\% & $ 0.319_{(2)} $ & $ \mathbf{ 0.198_{(1)} } $ & $ 0.354_{(3)} $ & $ 1.957_{(5)} $ & $ 1.220_{(4)} $ \\
	10\% & $ 0.171_{(2)} $ & $ \mathbf{ 0.142_{(1)} } $ & $ 0.264_{(3)} $ & $ 0.544_{(4)} $ & $ 1.220_{(5)} $ \\
	20\% & $ 0.127_{(2)} $ & $ \mathbf{ 0.114_{(1)} } $ & $ 0.244_{(3)} $ & $ 0.318_{(4)} $ & $ 1.472_{(5)} $ \\
	40\% & $ 0.095_{(2)} $ & $ \mathbf{ 0.092_{(1)} } $ & $ 0.199_{(3)} $ & $ 0.219_{(4)} $ & $ 1.648_{(5)} $ \\
	60\% & $ 0.085_{(2)} $ & $ \mathbf{ 0.082_{(1)} } $ & $ 0.181_{(4)} $ & $ 0.180_{(3)} $ & $ 1.649_{(5)} $ \\
	80\% & $ \mathbf{ 0.075_{(1)} } $ & $ 0.076_{(2)} $ & $ 0.127_{(3)} $ & $ 0.160_{(4)} $ & $ 1.604_{(5)} $ \\
	85\% & $ \mathbf{ 0.074_{(1)} } $ & $ 0.075_{(2)} $ & $ 0.121_{(3)} $ & $ 0.148_{(4)} $ & $ 1.549_{(5)} $ \\ \hline
	rank &1.71 &1.29 &3.14 &4.00 &4.86 \\
\end{tabular}
\end{table}

\begin{table} [htbp]
\centering
\caption{RMSE of (Berkeley, random, light)}
\label{table:berkeley_random_light}
\begin{tabular}{ r |  r r r r r}
	train	&LI	&TRMF	&AKE	&DESM	&STI\\ \hline
%	5\% & $ 70.8_{(2)} $ & $ \mathbf{ 51.4_{(1)} } $ & $ 74.8_{(3)} $ & $ 18531.4_{(5)} $ & $ 225.6_{(4)} $ \\
	10\% & $ 52.9_{(2)} $ & $ \mathbf{ 35.5_{(1)} } $ & $ 61.2_{(3)} $ & $ 6250.4_{(5)} $ & $ 258.2_{(4)} $ \\
	20\% & $ 38.7_{(2)} $ & $ \mathbf{ 28.2_{(1)} } $ & $ 53.0_{(3)} $ & $ 215.9_{(4)} $ & $ 311.0_{(5)} $ \\
	40\% & $ 29.9_{(2)} $ & $ \mathbf{ 21.2_{(1)} } $ & $ 41.4_{(3)} $ & $ 356.7_{(5)} $ & $ 356.3_{(4)} $ \\
	60\% & $ 25.0_{(2)} $ & $ \mathbf{ 17.2_{(1)} } $ & $ 33.7_{(3)} $ & $ 112.6_{(4)} $ & $ 366.9_{(5)} $ \\
	80\% & $ 23.9_{(2)} $ & $ \mathbf{ 17.7_{(1)} } $ & $ 27.9_{(3)} $ & $ 41.7_{(4)} $ & $ 363.3_{(5)} $ \\
	85\% & $ 20.9_{(2)} $ & $ \mathbf{ 14.4_{(1)} } $ & $ 24.3_{(3)} $ & $ 44.4_{(4)} $ & $ 354.2_{(5)} $ \\ \hline
	rank &2.00 &1.00 &3.00 &4.43 &4.57 \\
\end{tabular}
\end{table}

\begin{table}[htbp]
\centering
\caption{RMSE of (Berkeley, random, temperature)}
\label{table:berkeley_random_tem}
\begin{tabular}{ r | r r r r r}
	train	&LI	&TRMF	&AKE	&DESM	&STI\\ \hline
%	5\% & $ 15.725_{(4)} $ & $ 4.690_{(2)} $ & $ \mathbf{ 4.671_{(1)} } $ & $ 21.981_{(5)} $ & $ 14.998_{(3)} $ \\
	10\% & $ 11.630_{(4)} $ & $ 3.524_{(2)} $ & $ \mathbf{ 3.486_{(1)} } $ & $ 19.817_{(5)} $ & $ 10.625_{(3)} $ \\
	20\% & $ 7.269_{(4)} $ & $ 2.583_{(2)} $ & $ \mathbf{ 2.558_{(1)} } $ & $ 14.634_{(5)} $ & $ 6.745_{(3)} $ \\
	40\% & $ 4.233_{(3)} $ & $ 1.932_{(2)} $ & $ \mathbf{ 1.921_{(1)} } $ & $ 8.986_{(5)} $ & $ 5.021_{(4)} $ \\
	60\% & $ 3.184_{(3)} $ & $ 1.664_{(2)} $ & $ \mathbf{ 1.649_{(1)} } $ & $ 6.396_{(5)} $ & $ 4.710_{(4)} $ \\
	80\% & $ 2.690_{(3)} $ & $ 1.565_{(2)} $ & $ \mathbf{ 1.546_{(1)} } $ & $ 4.714_{(5)} $ & $ 4.605_{(4)} $ \\
	85\% & $ 2.588_{(3)} $ & $ 1.503_{(2)} $ & $ \mathbf{ 1.489_{(1)} } $ & $ 4.382_{(4)} $ & $ 4.671_{(5)} $ \\ \hline
	rank &3.43 &2.00 &1.00 &4.86 &3.71 \\
\end{tabular}
\end{table}

Table \ref{table:traffic_random_hum} and \ref{table:traffic_random_tem} show the result of random split on traffic data set. Again, TRMF outperforms other models significantly. However, the performance of linear interpolation deteriorates a lot. This corresponds to the low sampling rate in traffic data set. 

\begin{table} [htbp]
\centering
\caption{RMSE of (traffic, random, humidity)}
\label{table:traffic_random_hum}
\begin{tabular}{ r | r r r r r}
	train	&LI	&TRMF	&AKE	&DESM	&STI\\ \hline
%	5\% & $ 15.725_{(4)} $ & $ \mathbf{ 4.690_{(1)} } $ & $ 11.894_{(2)} $ & $ 21.981_{(5)} $ & $ 14.998_{(3)} $ \\
	10\% & $ 11.630_{(4)} $ & $ \mathbf{ 3.524_{(1)} } $ & $ 7.307_{(2)} $ & $ 19.817_{(5)} $ & $ 10.625_{(3)} $ \\
	20\% & $ 7.269_{(4)} $ & $ \mathbf{ 2.583_{(1)} } $ & $ 4.559_{(2)} $ & $ 14.634_{(5)} $ & $ 6.745_{(3)} $ \\
	40\% & $ 4.233_{(3)} $ & $ \mathbf{ 1.932_{(1)} } $ & $ 3.458_{(2)} $ & $ 8.986_{(5)} $ & $ 5.021_{(4)} $ \\
	60\% & $ 3.184_{(3)} $ & $ \mathbf{ 1.664_{(1)} } $ & $ 2.901_{(2)} $ & $ 6.396_{(5)} $ & $ 4.710_{(4)} $ \\
	80\% & $ 2.690_{(3)} $ & $ \mathbf{ 1.565_{(1)} } $ & $ 2.511_{(2)} $ & $ 4.714_{(5)} $ & $ 4.605_{(4)} $ \\
	85\% & $ 2.588_{(3)} $ & $ \mathbf{ 1.503_{(1)} } $ & $ 2.401_{(2)} $ & $ 4.382_{(4)} $ & $ 4.671_{(5)} $ \\ \hline
	rank &3.43 &1.00 &2.00 &4.86 &3.71 \\
\end{tabular}
\end{table}

\begin{table} [htbp]
\centering
\caption{RMSE of (traffic, random, temperature)}
\label{table:traffic_random_tem}
\begin{tabular}{ r | r r r r r}
	train	&LI	&TRMF	&AKE	&DESM	&STI\\ \hline
%	5\% & $ 5.306_{(4)} $ & $ \mathbf{ 1.632_{(1)} } $ & $ 4.014_{(2)} $ & $ 6.855_{(5)} $ & $ 5.149_{(3)} $ \\
	10\% & $ 4.000_{(4)} $ & $ \mathbf{ 1.214_{(1)} } $ & $ 2.509_{(2)} $ & $ 6.212_{(5)} $ & $ 3.662_{(3)} $ \\
	20\% & $ 2.508_{(4)} $ & $ \mathbf{ 0.898_{(1)} } $ & $ 1.538_{(2)} $ & $ 4.867_{(5)} $ & $ 2.261_{(3)} $ \\
	40\% & $ 1.477_{(3)} $ & $ \mathbf{ 0.689_{(1)} } $ & $ 1.192_{(2)} $ & $ 3.149_{(5)} $ & $ 1.732_{(4)} $ \\
	60\% & $ 1.101_{(3)} $ & $ \mathbf{ 0.585_{(1)} } $ & $ 1.005_{(2)} $ & $ 2.275_{(5)} $ & $ 1.597_{(4)} $ \\
	80\% & $ 0.938_{(3)} $ & $ \mathbf{ 0.551_{(1)} } $ & $ 0.885_{(2)} $ & $ 1.702_{(5)} $ & $ 1.574_{(4)} $ \\
	85\% & $ 0.915_{(3)} $ & $ \mathbf{ 0.519_{(1)} } $ & $ 0.866_{(2)} $ & $ 1.494_{(4)} $ & $ 1.585_{(5)} $ \\ \hline
	rank &3.43 &1.00 &2.00 &4.86 &3.71 \\
\end{tabular}
\end{table}

\subsubsection{Temporal Split}
\textbf{Table \ref{table:berkeley_temporal_hum}, \ref{table:berkeley_temporal_light} and \ref{table:berkeley_temporal_tem}} show the result of random split on Berkeley data set and \textbf{Table \ref{table:traffic_temporal_hum} and \ref{table:traffic_temporal_tem}} show the result of random split on traffic data set.
In the temporal split, it is clear that linear interpolation performs terribly since its prediction is simply the last reading of the sensor.

\begin{table}[htbp]
\centering
\caption{RMSE of (Berkeley, temporal, humidity)}
\label{table:berkeley_temporal_hum}
\begin{tabular}{ r | r r r r r}
	train	&LI	&TRMF	&AKE	&DESM	&STI\\ \hline
	85\%	&3.9669	&1.1250	&1.4492	&3.9682	&0.7876\\ 
	80\%	&4.1829	&1.0069	&1.6694	&4.1853	&0.7918\\
	70\%	&5.4211	&1.2549	&0.9690	&5.4217	&0.8651\\
	50\%	&6.4429	&0.8844	&1.0252	&6.4431	&0.9612\\
	30\%	&2.2225	&0.9314	&0.9280	&2.2335	&0.8643\\
	10\%	&1.2076	&0.5392	&0.6358	&1.2165	&0.6878\\
	 5\%	&2.3060	&0.4285	&0.7768	&2.3077	&0.7960
\end{tabular}
\end{table}

\begin{table}[htbp]
\centering
\caption{RMSE of (Berkeley, temporal, light)}
\label{table:berkeley_temporal_light}
\begin{tabular}{ r | r r r r r}
	train	&LI	&TRMF	&AKE	&DESM	&STI\\ \hline
	85\%	&330.55	&176.51	&196.39	&330.85	&251.32\\ 
	80\%	&320.02	&166.79	&239.09	&320.00	&251.35\\
	70\%	&497.84	&120.53	&257.11	&499.70	&206.58\\
	50\%	&194.54	&58.39	&68.55	&195.17	&208.28\\
	30\%	&312.10	&33.83	&77.45	&312.12	&289.20\\
	10\%	&293.47	&20.60	&84.89	&293.87	&213.90\\
	 5\%	&277.85	&7.81	&79.05	&280.36	& 92.72
\end{tabular}
\end{table}


\begin{table}[htbp]
\centering
\caption{RMSE of (Berkeley, temporal, temperature)}
\label{table:berkeley_temporal_tem}
\begin{tabular}{ r | r r r r r}
	train	&LI	&TRMF	&AKE	&DESM	&STI\\ \hline
	85\%	&3.0873	&0.6098	&0.5312	&3.0876	&0.4786\\ 
	80\%	&3.7602	&0.6221	&0.5136	&3.7606	&0.4921\\
	70\%	&2.3195	&0.4429	&0.4058	&2.3214	&0.4152\\
	50\%	&3.5948	&0.3029	&0.3037	&3.5952	&0.4859\\
	30\%	&1.9598	&0.2247	&0.3402	&1.9615	&0.5322\\
	10\%	&0.8870	&0.2364	&0.2796	&0.8941	&0.3263\\
	 5\%	&1.0241	&0.0853	&0.3047	&1.0156	&0.3506
\end{tabular}
\end{table}

\begin{table} [htbp]
\centering
\caption{RMSE of (traffic, temporal, humidity)}
\label{table:traffic_temporal_hum}
\begin{tabular}{ r | r r r r r}
	testing	&LI	&TRMF	&Hybrid-kNN \\ \hline
	85\%	&16.6428	&5.3882	&5.3955\\ 
	80\%	&27.7509	&5.0636	&5.0810\\
	70\%	&21.4693	&5.5701	&5.0198\\
	50\%	&25.8277	&5.8469	&5.1926\\
	30\%	&27.4891	&5.0048	&5.0268\\
	10\%	&18.9358	&4.6402	&4.1944\\
	 5\%	&23.5126	&4.0820	&3.6661
\end{tabular}
\end{table}


\begin{table} [htbp]
\centering
\caption{RMSE of (traffic, temporal, temperture)}
\label{table:traffic_temporal_tem}
\begin{tabular}{ r | r r r r r}
	testing	&LI	&TRMF	&Hybrid-kNN \\ \hline
	85\%	& 8.6774	&2.0011	&1.8381\\ 
	80\%	&11.4353	&1.5281	&1.6787\\
	70\%	& 7.1857	&1.8447	&1.6644\\
	50\%	&10.5938	&1.7748	&1.5793\\
	30\%	&14.1343	&1.6737	&1.6874\\
	10\%	&16.1660	&1.4345	&1.4137\\
	 5\%	&10.0223	&1.4254	&1.3560
\end{tabular}
\end{table}

\subsubsection{Multivariate TRMF}
We see substantial improvement (if look at all to help) 

\begin{table}[htbp]
\caption{Multivariate TRMF on Traffic Data Set}
\label{traffic}
\begin{tabular}{r | r r r}
traffic dataset	&TRMF	&MtMF	&MtMF-all \\ \hline
humid 5-10-85	&4.6898	&4.6690	&3.0966\\
humid10-10-80	&3.5391	&3.5232	&2.3081\\
humid20-10-70	&2.5865	&2.5886	&1.8027\\
humid40-10-50	&1.9503	&1.9435	&1.5207\\
humid60-10-30	&1.6748	&1.6594	&1.4116\\
humid80-10-10	&1.5707	&1.5574	&1.3706\\
humid85-10- 5	&1.5098	&1.4963	&1.3301\\
 temp 5-10-85	&1.6235	&1.6105	&0.9620\\
 temp10-10-80	&1.2159	&1.2186	&0.7305\\
 temp20-10-70	&0.9017	&0.8936	&0.6002\\
 temp40-10-50	&0.6898	&0.6819	&0.5200\\
 temp60-10-30	&0.5865	&0.5818	&0.4770\\
 temp80-10-10	&0.5521	&0.5464	&0.4652\\
 temp85-10- 5	&0.5196	&0.5126	&0.4319\\
humid 5-10-85t	&5.3882	&5.3994	&5.1394\\
humid10-10-80t	&5.0636	&5.2424	&4.2964\\
humid20-10-70t	&5.5701	&5.6727	&4.2332\\
humid40-10-50t	&5.8469	&6.0046	&4.6036\\
humid60-10-30t	&5.0048	&4.9566	&3.7443\\
humid80-10-10t	&4.6402	&4.7294	&3.2574\\
humid85-10- 5t	&4.0820	&3.9843	&3.1709\\
 temp 5-10-85t	&2.0011	&2.0344	&1.5952\\
 temp10-10-80t	&1.5281	&1.7150	&1.2174\\
 temp20-10-70t	&1.8447	&1.9223	&1.1501\\
 temp40-10-50t	&1.7748	&1.7961	&1.0494\\
 temp60-10-30t	&1.6737	&1.6819	&1.2274\\
 temp80-10-10t	&1.4345	&1.4225	&0.9267\\
 temp85-10- 5t	&1.4254	&1.3374	&0.9259

\end{tabular}
\end{table}

\begin{table}[htbp]
\caption{Multivariate TRMF on Berkeley Data Set, random}
\label{traffic}
\begin{tabular}{r | r r r}
berkeley dataset	&TRMF	&MtMF	&MtMF-all \\ \hline
humid  5 &0.1936	&0.1941	&0.1594\\
humid 10 &0.1424	&0.1421	&0.1219\\
humid 20 &0.1140	&0.1139	&0.0975\\
humid 40 &0.0918	&0.0910	&0.0824\\
humid 60 &0.0815	&0.0808	&0.0762\\
humid 80 &0.0756	&0.0749	&0.0712\\
humid 85 &0.0750	&0.0740	&0.0713\\
 temp  5 &0.1136	&0.1158	&0.0694\\
 temp 10 &0.0454	&0.0482	&0.0371\\
 temp 20 &0.0316	&0.0329	&0.0264\\
 temp 40 &0.0232	&0.0233	&0.0201\\
 temp 60 &0.0181	&0.0183	&0.0166\\
 temp 80 &0.0155	&0.0155	&0.0144\\
 temp 85 &0.0158	&0.0159	&0.0142
\end{tabular}
\end{table}
\subsection{Heterogeneous Signal Incorporation}

We compare our TF method with the models without modeling heterogeneous sensor correlations in this section.
The Tensor Factorization naturally allow us to add additional nominal dimensions to the model, e.g.\ node id or sensor coordinates.
The three-order TF is used in the experiment, each dimension represent node id, time frame number and heterogeneous signal.  
Due to the indexes of each dimension are discrete, the heterogeneous sensor data are not able directly used.
Therefore, the discretization of heterogeneous data is needed.
Before training, the heterogeneous signal are divide into some bins according to the value.
Each bin represents the index of the dimension.
Table ? and ? show the TF result of random split and temporal split on Berkeley dataset while table ? and ? show the TF result of random split and temporal split on traffic dataset.

\subsection{Prediction Performance}
In this section, we measure the performance of missing value recovery algorithms by regression methods.
We demonstrate the experiment on traffic dataset.
The readings of gateway node are to be predicted in offline mode.
At the sane time the data from gateway is the label of a instance while the data from the other sensor nodes are the features of a instance.
80 percent of instance are split to be training data, the remaining part is the testing data.
Firstly, we filling the features from training and testing data by global mean, linear interpolation, KNN, and TRMF model.
The regression model we choose is linear regression(LR) and support vector regression(SVR).
The former is a linear model.
In contrast, the latter is a nonlinear model.
Table ? show the result with different data missing rate.
It is obvious that the more higher quality filling value will help the regression model predicting the objective sensor more precise.

\begin{table} [htbp]
\centering
\caption{predict gateway humidity by LR (RMSE) }
\label{table: LR}
   Filling method
\begin{tabular}{ r | r r r r r}
        missing rate&global mean     &LI   &Hybrid-KNN &TRMF\\ \hline
        10\%    &4.143&3.868&&2.526\\
        30\%    &5.161&3.955&&2.470\\
        50\%    &6.234&4.282&&2.756\\
        70\%   &7.728&5.082&&2.743
\end{tabular}
\end{table}

\begin{table}[htbp]
\centering
\caption{predict gateway humidity by SVR (RMSE) }
\label{table: SVR}
   Filling method
\begin{tabular}{ r | r r r r r}
        missing rate&global mean     &LI   &Hybrid-KNN &TRMF\\ \hline
        10\%    &3.933 &4.006&&2.591\\
        30\%    &5.172&4.083&&2.532\\
        50\%    &6.234&4.384&&2.813\\
        70\%   &7.686&5.235&&2.822
\end{tabular}
\end{table}
